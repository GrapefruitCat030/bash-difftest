在POSIX shell中使用`test`或`[ ]`时，**变量必须用引号包围**以防止空变量或含空格变量导致的错误

## 基本结构和字符串比较

| Bash 条件表达式语法特性          | POSIX Shell 相同语义实现方法                                 |
| -------------------------------- | ------------------------------------------------------------ |
| `[[ $a == $b ]]`                 | `[ "$a" = "$b" ]`                                            |
| `[[ $a == a* ]]` (支持模式匹配)  | `[ "$a" = a* ]` (需在模式匹配模式下) 或 `case "$a" in a*) true;; *) false;; esac` |
| `[[ $a != $b ]]`                 | `[ "$a" != "$b" ]`                                           |
| `[[ $a < $b ]]` (字符串顺序比较) | `[ "$a" \< "$b" ]` (需要转义)                                |
| `[[ $a > $b ]]` (字符串顺序比较) | `[ "$a" \> "$b" ]` (需要转义)                                |

## 逻辑操作符和分组

| Bash 条件表达式语法特性                                | POSIX Shell 相同语义实现方法                                |
| ------------------------------------------------------ | ----------------------------------------------------------- |
| 简单与操作：`[[ $a -eq 5 && $b -eq 6 ]]`               | `[ "$a" -eq 5 ] && [ "$b" -eq 6 ]`                          |
| 简单或操作：`[[ $a -eq 5 || $b -eq 6 ]]`               | `[ "$a" -eq 5 ] || [ "$b" -eq 6 ]`                          |
| 简单非操作：`[[ ! $a = $b ]]`                          | `[ ! "$a" = "$b" ]` 或 `[ "$a" != "$b" ]`                   |
| 组合操作1：`[[ ! $a -eq 5 && $b = foo ]]`              | `[ ! "$a" -eq 5 ] && [ "$b" = "foo" ]`                      |
| 组合操作2：`[[ $a -eq 5 || ! ( $b -eq 6 ) ]]`          | `[ "$a" -eq 5 ] || [ ! "$b" -eq 6 ]`                        |
| 组合操作3：`[[ ! ( $a != foo && $b != bar ) ]]`        | `[ ! "$a" != foo ] || [ ! "$b" != bar ]`                    |
| 复杂组合：`[[ ! $a = foo && ($b = bar || $c = baz) ]]` | `[ ! "$a" = foo ] && { [ "$b" = bar ] || [ "$c" = baz ]; }` |

## 文件测试和变量检查

| Bash 条件表达式语法特性                       | POSIX Shell 相同语义实现方法           |
| --------------------------------------------- | -------------------------------------- |
| `[[ -v myvar ]]` (变量存在检查)               | `[ -n "${myvar+x}" ]`                  |
| `[[ -r $file && -s $file ]]` (文件可读且非空) | `[ -r "$file" ] && [ -s "$file" ]`     |
| `[[ ! -z $var ]]` (变量非空)                  | `[ -n "$var" ]`                        |
| `[[ -n $var && $var != foo ]]`                | `[ -n "$var" ] && [ "$var" != "foo" ]` |

## 特殊处理特性

| Bash 条件表达式语法特性               | POSIX Shell 相同语义实现方法                     |
| ------------------------------------- | ------------------------------------------------ |
| `[[ -n $var ]]` (没有引号也安全)      | `[ -n "$var" ]` (必须使用引号)                   |
| `[[ $a =~ [0-9]+ ]]` (正则表达式匹配) | `(echo "$a" | grep -Eq "[0-9]+")` (使用subshell) |
